{%load static%}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% if site_settings.college_name %}{{ site_settings.college_name }}{% else %}Your College Name{% endif %}{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    </head>
<body>
    <header>
        <div class="logo-name">
            {% load static %}
            {% if site_settings.logo %}
            <a href="/">
                <img src="{{ site_settings.logo.url }}" alt="College Logo" class="logo">
            </a>
            {% else %}
            <a href="/">
                <img src="{% static 'images/default_logo.png' %}" alt="Default College Logo" class="logo">
            </a>
            {% endif %}
            <h3>{% if site_settings.college_name %}{{ site_settings.college_name }}{% else %}Your College Name{% endif %}</h3>
        </div>
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li class="dropdown">
                    <a href="/about/">About Us</a>
                    <ul class="dropdown-menu">
                        <li><a href="/about/mission/">Mission</a></li>
                        <li><a href="/about/vision/">Vision</a></li>
                        <li><a href="/about/principal/">Principal's Message</a></li>
                        </ul>
                </li>
                <li><a href="/facilities/">Facilities</a></li>
                <li class="dropdown">
                    <a href="/academics/">Academics</a>
                    <ul class="dropdown-menu">
                        <li><a href="/academics/courses/">Courses Offered</a></li>
                        <li><a href="/academics/admission/">Admission Process</a></li>
                        <li><a href="/academics/calendar/">Academic Calendar</a></li>
                        </ul>
                </li>
                <li><a href="/naac/">NAAC</a></li>
                <li><a href="/departments/">Departments</a></li> <li><a href="/admin/" class="authority-button">Authority</a></li>
            
            </ul>
        </nav>
    </header>

    <div class="content">
        {% block content %}
        {% endblock %}
    </div>

    <footer>
        <div class="footer-content">
            <p>&copy; {% now "Y" %} {% if site_settings.college_name %}{{ site_settings.college_name }}{% else %}Your College Name{% endif %}. All Rights Reserved.</p>
            <ul class="footer-links">
                <li><a href="/privacy-policy/">Privacy Policy</a></li>
                <li><a href="/terms-of-use/">Terms of Use</a></li>
                <li><a href="/contact-us/">Contact Us</a></li>
            </ul>
        </div>
    </footer>

    {% load static %}
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script src="{% static 'js/script.js' %}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            fetch('/api/departments-subdepartments/')
                .then(response => response.json())
                .then(data => {
                    const departmentSubmenu = document.getElementById('department-submenu');
                    data.forEach(department => {
                        const departmentItem = document.createElement('li');
                        const departmentLink = document.createElement('a');
                        departmentLink.href = `/departments/${department.slug}/`;
                        departmentLink.textContent = department.name;
                        departmentItem.appendChild(departmentLink);

                        if (department.subdepartments && department.subdepartments.length > 0) {
                            const sublist = document.createElement('ul');
                            sublist.classList.add('sub-dropdown-menu');
                            department.subdepartments.forEach(subdepartment => {
                                const sublistItem = document.createElement('li');
                                const subLink = document.createElement('a');
                                subLink.href = `/sub-departments/${subdepartment.slug}/`;
                                subLink.textContent = subdepartment.name;
                                sublistItem.appendChild(subLink);
                                sublist.appendChild(sublistItem);
                            });
                            departmentItem.appendChild(sublist);
                            departmentItem.classList.add('has-submenu');
                            departmentLink.classList.add('has-submenu-arrow');
                        }
                        departmentSubmenu.appendChild(departmentItem);
                    });

                    const dropdowns = document.querySelectorAll('.dropdown');
                    dropdowns.forEach(dropdown => {
                        dropdown.addEventListener('mouseover', function() {
                            this.querySelector('.dropdown-menu').style.display = 'block';
                        });
                        dropdown.addEventListener('mouseout', function() {
                            this.querySelector('.dropdown-menu').style.display = 'none';
                        });
                    });

                    const departmentDropdown = document.querySelector('.department-dropdown');
                    departmentDropdown.addEventListener('mouseover', function() {
                        this.querySelector('#department-submenu').style.display = 'block';
                    });
                    departmentDropdown.addEventListener('mouseout', function() {
                        this.querySelector('#department-submenu').style.display = 'none';
                    });
                })
                .catch(error => {
                    console.error('Error fetching departments and sub-departments:', error);
                    const departmentSubmenu = document.getElementById('department-submenu');
                    const errorItem = document.createElement('li');
                    errorItem.textContent = 'Error loading departments';
                    departmentSubmenu.appendChild(errorItem);
                });
        });
    </script>
</body>
</html>